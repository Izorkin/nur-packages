diff --git a/ext/openssl/openssl.c b/ext/openssl/openssl.c
index 18c822ed67..2665798d00 100644
--- a/ext/openssl/openssl.c
+++ b/ext/openssl/openssl.c
@@ -6900,8 +6900,10 @@ static void php_openssl_load_cipher_mode(struct php_openssl_cipher_mode *mode, c
 {
 	int cipher_mode = EVP_CIPHER_mode(cipher_type);
 	memset(mode, 0, sizeof(struct php_openssl_cipher_mode));
-	switch (cipher_mode) {
-#if PHP_OPENSSL_API_VERSION >= 0x10100
+	  switch (cipher_mode) {
+#ifdef EVP_CIPH_OCB_MODE
+		/* Since OpenSSL 1.1, all AEAD ciphers use a common framework. We check for
+		 * EVP_CIPH_OCB_MODE, because LibreSSL does not support it. */
 		case EVP_CIPH_GCM_MODE:
 		case EVP_CIPH_OCB_MODE:
 		case EVP_CIPH_CCM_MODE:
